// Tensor struct and core logic